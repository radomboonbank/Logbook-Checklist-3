
import streamlit as st
from datetime import datetime, timedelta
import json
import gspread
from google.oauth2.service_account import Credentials

st.set_page_config(page_title="Logbook Checklist", layout="wide")

# Load credentials from secrets
creds_dict = json.loads(st.secrets["GOOGLE_SERVICE_ACCOUNT"])
scoped_creds = Credentials.from_service_account_info(creds_dict, scopes=["https://www.googleapis.com/auth/spreadsheets"])
client = gspread.authorize(scoped_creds)

SHEET_ID = st.secrets["SHEET_ID"]
SHEET_NAME = st.secrets["SHEET_NAME"]
sheet = client.open_by_key(SHEET_ID).worksheet(SHEET_NAME)

st.title("üìã check-Sheet ‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏Å‡∏∞ ‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏ô‡∏ô‡∏ó‡∏ö‡∏∏‡∏£‡∏µ by Bank")

with st.form("log_form"):
    date = st.date_input("üìÖ ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö", value=datetime.today())
    time = st.time_input("‚è∞ ‡πÄ‡∏ß‡∏•‡∏≤", value=datetime.now().time(), step=timedelta(minutes=1))

    employee = st.selectbox("üë∑‚Äç‚ôÇÔ∏è ‡∏ä‡∏∑‡πà‡∏≠‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô", [
        "‡∏ô‡∏≤‡∏¢‡πÄ‡∏™‡∏ô‡πà‡∏´‡πå ‡∏Å‡∏≠‡∏á‡∏£‡∏™", "‡∏ô‡∏≤‡∏¢‡∏â‡∏±‡∏ï‡∏£‡∏ä‡∏±‡∏¢ ‡∏î‡∏≥‡∏Ñ‡∏≥", "‡∏ô‡∏≤‡∏¢‡∏à‡∏±‡∏Å‡∏£‡∏µ  ‡∏û‡∏±‡∏ô‡∏ò‡∏∏‡πå‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô", "‡∏ô‡∏≤‡∏¢‡πÄ‡∏à‡∏ï‡∏ô‡πå  ‡∏ö‡∏∏‡∏ç‡∏ç‡∏î‡∏¥‡πÄ‡∏£‡∏Å",
        "‡∏ô‡∏≤‡∏¢‡∏ó‡∏£‡∏á‡∏®‡∏±‡∏Å‡∏î‡∏¥‡πå  ‡∏ß‡∏ô‡∏≤‡∏ô‡∏∏‡∏Å‡∏±‡∏ì‡∏ë‡πå", "‡∏ô‡∏≤‡∏¢‡∏™‡∏¥‡∏£‡∏¥‡∏û‡∏á‡∏©‡πå  ‡∏™‡∏¥‡∏ô‡∏à‡∏¥‡∏ô‡∏≤", "‡∏ô‡∏≤‡∏¢‡∏ô‡∏¥‡∏ß‡∏±‡∏í‡∏ô‡πå ‡πÄ‡∏Å‡πà‡∏á‡∏Å‡∏•‡πâ‡∏≤", "‡∏ô‡∏≤‡∏¢‡∏ò‡∏µ‡∏£‡∏±‡∏Å‡∏ä‡∏≤‡∏ï‡∏¥ ‡∏Ç‡∏≥‡∏™‡∏≤‡∏¢",
        "‡∏ô‡∏≤‡∏¢‡∏£‡∏∞‡∏î‡∏°‡∏ö‡∏∏‡∏ç ‡∏ó‡∏±‡∏Å‡∏©‡∏ì‡∏≤", "‡∏ô‡∏≤‡∏¢‡∏•‡∏≤‡∏†‡∏ä‡∏ô‡∏Å  ‡∏ó‡∏¥‡∏°‡∏™‡∏ñ‡∏¥‡∏ï‡∏¢‡πå", "‡∏ô‡∏≤‡∏¢‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏û‡∏á‡∏©‡πå  ‡∏´‡∏•‡∏á‡πÄ‡∏à‡∏£‡∏¥‡∏ç", "‡∏ô‡∏≤‡∏¢‡∏†‡∏≤‡∏Ñ‡∏†‡∏π‡∏°‡∏¥  ‡∏ô‡∏¥‡∏•‡∏ò‡∏Å‡∏¥‡∏à",
        "‡∏ô‡∏≤‡∏¢‡∏≠‡∏≤‡∏ô‡∏∏‡∏†‡∏≤‡∏û ‡∏û‡∏§‡∏Å‡∏©‡∏≤‡∏ß‡∏≤‡∏ì‡∏¥‡∏ä‡∏¢‡πå", "‡∏ô‡∏≤‡∏¢‡∏ô‡∏û‡∏ô‡∏±‡∏ê  ‡∏°‡∏¥‡∏ï‡∏£‡∏™‡∏°‡∏≤‡∏ô", "‡∏ô‡∏≤‡∏¢‡∏™‡∏£‡∏û‡∏•  ‡∏≠‡∏∂‡πä‡∏á‡∏≠‡∏≤‡∏†‡∏£‡∏ì‡πå", "‡∏ô‡∏≤‡∏¢‡∏ò‡∏ô‡∏Å‡∏£ ‡∏ó‡∏¥‡∏û‡∏¢‡πå‡πÄ‡∏ó‡∏µ‡πà‡∏¢‡∏á‡πÅ‡∏ó‡πâ"
    ])
    receiver = st.selectbox("üì´ ‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö‡∏Å‡∏∞", [
        "‡∏ô‡∏≤‡∏¢‡πÄ‡∏™‡∏ô‡πà‡∏´‡πå ‡∏Å‡∏≠‡∏á‡∏£‡∏™", "‡∏ô‡∏≤‡∏¢‡∏â‡∏±‡∏ï‡∏£‡∏ä‡∏±‡∏¢ ‡∏î‡∏≥‡∏Ñ‡∏≥", "‡∏ô‡∏≤‡∏¢‡∏à‡∏±‡∏Å‡∏£‡∏µ  ‡∏û‡∏±‡∏ô‡∏ò‡∏∏‡πå‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô", "‡∏ô‡∏≤‡∏¢‡πÄ‡∏à‡∏ï‡∏ô‡πå  ‡∏ö‡∏∏‡∏ç‡∏ç‡∏î‡∏¥‡πÄ‡∏£‡∏Å",
        "‡∏ô‡∏≤‡∏¢‡∏ó‡∏£‡∏á‡∏®‡∏±‡∏Å‡∏î‡∏¥‡πå  ‡∏ß‡∏ô‡∏≤‡∏ô‡∏∏‡∏Å‡∏±‡∏ì‡∏ë‡πå", "‡∏ô‡∏≤‡∏¢‡∏™‡∏¥‡∏£‡∏¥‡∏û‡∏á‡∏©‡πå  ‡∏™‡∏¥‡∏ô‡∏à‡∏¥‡∏ô‡∏≤", "‡∏ô‡∏≤‡∏¢‡∏ô‡∏¥‡∏ß‡∏±‡∏í‡∏ô‡πå ‡πÄ‡∏Å‡πà‡∏á‡∏Å‡∏•‡πâ‡∏≤", "‡∏ô‡∏≤‡∏¢‡∏ò‡∏µ‡∏£‡∏±‡∏Å‡∏ä‡∏≤‡∏ï‡∏¥ ‡∏Ç‡∏≥‡∏™‡∏≤‡∏¢",
        "‡∏ô‡∏≤‡∏¢‡∏£‡∏∞‡∏î‡∏°‡∏ö‡∏∏‡∏ç ‡∏ó‡∏±‡∏Å‡∏©‡∏ì‡∏≤", "‡∏ô‡∏≤‡∏¢‡∏•‡∏≤‡∏†‡∏ä‡∏ô‡∏Å  ‡∏ó‡∏¥‡∏°‡∏™‡∏ñ‡∏¥‡∏ï‡∏¢‡πå", "‡∏ô‡∏≤‡∏¢‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏û‡∏á‡∏©‡πå  ‡∏´‡∏•‡∏á‡πÄ‡∏à‡∏£‡∏¥‡∏ç", "‡∏ô‡∏≤‡∏¢‡∏†‡∏≤‡∏Ñ‡∏†‡∏π‡∏°‡∏¥  ‡∏ô‡∏¥‡∏•‡∏ò‡∏Å‡∏¥‡∏à",
        "‡∏ô‡∏≤‡∏¢‡∏≠‡∏≤‡∏ô‡∏∏‡∏†‡∏≤‡∏û ‡∏û‡∏§‡∏Å‡∏©‡∏≤‡∏ß‡∏≤‡∏ì‡∏¥‡∏ä‡∏¢‡πå", "‡∏ô‡∏≤‡∏¢‡∏ô‡∏û‡∏ô‡∏±‡∏ê  ‡∏°‡∏¥‡∏ï‡∏£‡∏™‡∏°‡∏≤‡∏ô", "‡∏ô‡∏≤‡∏¢‡∏™‡∏£‡∏û‡∏•  ‡∏≠‡∏∂‡πä‡∏á‡∏≠‡∏≤‡∏†‡∏£‡∏ì‡πå", "‡∏ô‡∏≤‡∏¢‡∏ò‡∏ô‡∏Å‡∏£ ‡∏ó‡∏¥‡∏û‡∏¢‡πå‡πÄ‡∏ó‡∏µ‡πà‡∏¢‡∏á‡πÅ‡∏ó‡πâ"
    ])
    shift = st.selectbox("üìÇ ‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡∏ï‡∏•‡∏≠‡∏î‡∏™‡∏≠‡∏ö", ["‡∏ï‡∏£‡∏ß‡∏à‡∏•‡∏∞ 00.00 - 08.00 ‡∏ô.", "‡∏ï‡∏£‡∏ß‡∏à‡∏•‡∏∞ 08.00 - 16.00 ‡∏ô.", "‡∏ï‡∏£‡∏ß‡∏à‡∏•‡∏∞ 16.00 - 24.00 ‡∏ô."])
    department = st.selectbox("üè¢ ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏ú‡∏ô‡∏Å‡∏ó‡∏µ‡πà‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö", ["‡πÅ‡∏ú‡∏ô‡∏Å ‡∏´‡∏≠‡∏Å1‡πÅ‡∏•‡∏∞2", "‡πÅ‡∏ú‡∏ô‡∏Å ‡∏´‡∏≠‡∏Å3‡πÅ‡∏•‡∏∞4", "‡πÅ‡∏ú‡∏ô‡∏Å ‡∏´‡∏≠‡∏Å5"])
    note = st.text_area("‚ùó ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏‡∏´‡∏£‡∏∑‡∏≠‡∏õ‡∏±‡∏ç‡∏´‡∏≤", "‡∏ñ‡πâ‡∏≤‡∏°‡∏µ")

    submitted = st.form_submit_button("‚úÖ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•")

    if submitted:
        row = [datetime.now().strftime("%Y%m%d%H%M%S"), str(date), str(time), employee, receiver, shift, department, "Alarm All", "‡∏õ‡∏Å‡∏ï‡∏¥", note]
        sheet.append_row(row)
        st.success("‚úÖ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß!")
